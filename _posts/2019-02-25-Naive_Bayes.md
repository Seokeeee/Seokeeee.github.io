---
layout: post
title: 나이브 베이즈 분류1
use_math: true
---
<br>
<br>
 이번 포스팅에서 알아볼 내용은 베이즈 정리(Bayes's theorem)에 기반한 데이터 과학 기법인 __나이브 베이즈 분류(Naive Bayesian Classification)__ 에 대해 알아보겠습니다. 해당 내용은 [비지니스를 위한 데이터과학](http://www.hanbit.co.kr/store/books/look.php?p_code=B9423118473, "데이터 과학")을 기반으로 정리했습니다.<br>
<br>
<br>
    



증거와 확률
----------------------------------------
데이터 집합은 객체들로 이루어져 있습니다. 이 객체는 각각의 특징들을 가지고 있으며 우리가 무엇인가 예측할 때, 이 특징들을 이용합니다. 이것을 확률 문제로 가져오면 객체의 특징들은 증거(Evidence)가 되며 예측하고자 하는 것은 가설(Hypothesis)이 됩니다. 그리고 이 증거들을 어떤 값들로 표현하여 통계적으로 결합하면 그것으로 타겟값(가설)을 도출할 수 있습니다. <br>

<br>
<br>
<br>

- 예제 (타겟광고)<br>
이번 프로젝트는 고급호텔인 X호텔을 인터넷에 광고하여 온라인 예약을 향상시키려고 합니다.<br>
여기서 X호텔 사이트에 예약할만한 사람들을 선별하여 타겟광고를 하는 것이 핵심입니다.<br>
타겟광고를 하려면 먼저, 어떤 사람들이 광고를 보고 온라인 예약을 했는지 알아봐야 합니다.<br>
우리는 어디서 광고를 보고 왔는지 고객이 방문한 웹사이트를 중심으로 분석할 것입니다.<br>
<br>
<br>
<br>

증거의 통계적 조합
-------------------
광고를 보고 (방을) 예약한 사람을 C라고 하면, C가 발생할 확률을 수식으로 표현하면 다음과 같습니다.<br>
$$ 
𝑝(𝐶)
$$
<br>1만명 중 1명이 광고를 보고 예약했다면 다음과 같습니다.<br>
$$
𝑝(𝐶) =0.0001 
$$
<br>여기서 C는 우리가 예측할 타겟이 되며 이 타겟을 예측하기 위한 증거는 고객이 방문한 웹사이트가 됩니다.<br>
증거는 $$𝐸$$라 표현하며, 어떤 웹사이트를 보고 광고를 예약할 확률을 다음과 같이 표현할 수 있습니다.<br>
$$
𝑝(𝐶│𝐸)
$$
<br>이 수식은 'E가 있을 때, C의 확률을 뜻합니다.<br>
<br>
<br>

결합 확률과 독립
-------------------
결합 확률이란 '사건 A와 B가 있을 때, A와 B사건 모두가 일어날 확률'을 말합니다. 
 > __증거의 통계적 조합__ 의 표현대로<br> 사건 A가 일어날 확률을 $$𝑝(𝐴)$$,<br> 사건 B가 일어날 확률을 $$𝑝(B)$$<br>라 할 수 있습니다.<br>

결합 확률은 다음과 같이 표현할 수 있습니다.<br>
$$
𝑝(𝐴𝐵)=𝑝(𝐴)×𝑝(𝐵) 
$$
<br>
<br>
여기서 유의해야 할 것은 사건 A와 B의 관계입니다. 사건 A와 B의 관계는 (1)완전 독립 관계 (2)부분 종속 관계 (3)완전 종속 관계로 정리할 수 있습니다. <br>

* 예시1
예를들어 주사위 하나를 한 번 던졌을 때, 확률은 $$1/6$$입니다.<br>
주사위를 두 번 던지면, 두 사건은 서로 '독립적'입니다.<br>
첫번째 던졌을 때를 $$𝑝(𝐴)$$, 두번째 던졌을 때를 $$𝑝(B)$$라고 하며 여기서 숫자 6이 나올 확률은 다음과 같습니다.<br>
$$
𝑝(𝐴𝐵) = 𝑝(𝐴) × 𝑝(𝐵)
       = 1/6 × 1/6
       = 1/36
$$
<br>반면에 여섯면이 각각 숫자 1부터 6까지로 이루어진 주사위 6개가 있는 주머니에서 하나를 꺼내 두번 던지면, 두 사건은 서로 '종속적'입니다.<br>
왜냐하면 여기서 확률은 주머니에 있는 주사위 6개중 하나를 꺼냈을 때만 적용되고 한 번 꺼낸 뒤, 몇 번을 던져도 같은 숫자가 나오기 때문입니다.<br>
따라서 숫자 6이 나올 결합 확률은 다음과 같습니다.<br>
$$
𝑝(𝐴𝐵) = 𝑝(𝐴) = 𝑝(𝐵)
1/6 = 1/6 = 1/6
    = 1/6
$$
<br>이렇게 사건간의 관계는 결합 확률의 값에도 영향을 주기 때문에 사건간의 관계를 고려하여 결합 확률 식을 만들 필요가 있습니다. 이 식은 다음과 같습니다.<br>
$$
𝑝(𝐴𝐵) = 𝑝(𝐴) × 𝑝(𝐵│𝐴)
$$
<br> 이 식의 의미는 '사건 A와 B가 동시에 일어날 확률'은 '사건 A가 일어날 확률'곱하기 '사건 A가 일어났을 때, 사건 B가 일어날 확률'입니다.<br>
이 식을 예시1에 적용시키면 같은 값을 얻을 수 있습니다. 
    
* 예시1(독립적일 때)
$$
𝑝(𝐴𝐵) = 𝑝(𝐴) × 𝑝(𝐵│𝐴)
= 1/6 × 1/6(서로 독립적이므로)
= 1/36
$$
<br>
* 예시1(종속적일 때)
$$ 
𝑝(𝐴𝐵) = 𝑝(𝐴) × 𝑝(𝐵│𝐴)
= 1/6 × 1.0(주사위를 꺼낸 뒤, 사건 B는 사건 A에 대해 종속적이므로 값은 1)
= 1/6
$$
    
이렇게 두 사건의 관계를 고려한 결합 확률식을 만들어내면 사건간의 관계가 어떻게 되든 이 식을 사용할 수 있습니다. 또 이 식을 통해 다음의 베이즈 규칙을 유도할 수 있습니다.<br>
<br>
<br>

베이즈 규칙
---------------------
$$𝑝(𝐴𝐵) = 𝑝(𝐴) × 𝑝(𝐵│𝐴)$$는 사건 A와 B의 순서와 상관이 없습니다.
$$
𝑝(𝐴) × 𝑝(𝐵│𝐴) = 𝑝(𝐴𝐵) = 𝑝(𝐵) × 𝑝(𝐴│𝐵)
𝑝(𝐴) × 𝑝(𝐵│𝐴) = 𝑝(𝐵) × 𝑝(𝐴│𝐵)
$$
<br>이 등식을 $$𝑝(𝐴)$$로 나누면 다음과 같습니다.<br>
$$
𝑝(𝐵│𝐴) = (𝑝(𝐴│𝐵) × 𝑝(𝐵)) / 𝑝(𝐴) 
$$
<br> 이 식의 의미는 " '사건 A가 일어났을 때, 사건 B가 일어날 확률'은 ('사건 B가 일어났을 때, 사건 A가 일어날 확률'곱하기 '사건 B가 일어날 확률')을 '사건 A가 일어날 확률'로 나눈다. "를 의미합니다. 아직 이 뜻이 무슨 뜻인지 감이 오지 않겠지만 다음의 내용을 적용하면 마법같이 해결됩니다.<br>
> 이것을 __증거와 확률__ 의 내용을 적용하면 다음과 같습니다.<br> 
사건 A는 증거(Evidence), 사건 B는 가설(Hypothesis)이라고 생각하면 식은<br>
$$
𝑝(𝐻│𝐸) =  (𝑝(𝐸│𝐻) × 𝑝(𝐻)) / 𝑝(𝐸)
$$

<br>이렇게 식을 바꾸면 '증거 $$𝐸$$가 있을 때, 가설 $$𝐻$$가 성립할 확률'이 됩니다.<br>
앞의 예제를 적용하면 '어떤 사이트에 방문했을 때, 온라인 예약을 할 확률'이 되는 것입니다.<br>
이제 나이브 베이즈를 이해하기 위한 사전 공부는 끝났습니다. 다음 포스팅에서 __나이브 베이즈 분류(Naive Bayesian Classification)__ 를 다루겠습니다. 
